!function t(e,n,r){function o(s,u){if(!n[s]){if(!e[s]){var a="function"==typeof require&&require;if(!u&&a)return a(s,!0);if(i)return i(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var f=n[s]={exports:{}};e[s][0].call(f.exports,function(t){var n=e[s][1][t];return o(n?n:t)},f,f.exports,t,e,n,r)}return n[s].exports}for(var i="function"==typeof require&&require,s=0;s<r.length;s++)o(r[s]);return o}({1:[function(t,e,n){function r(){return!!("undefined"!=typeof cc&&cc&&cc.sys&&cc.sys.isNative)}var o,i=t("util");if(function(){o=this}(),r()){var s=cc;o.console=s,cc.formatStr=i.format}var u=t("events").EventEmitter;o.EventEmitter=u;var a=t("pomelo-protobuf");o.protobuf=a;var c=t("pomelo-protocol");o.Protocol=c;var f=t("pomelo-jsclient-websocket");o.pomelo=f},{events:6,"pomelo-jsclient-websocket":11,"pomelo-protobuf":17,"pomelo-protocol":19,util:10}],2:[function(t,e,n){function r(t,e){var n=this;if(!(n instanceof r))return new r(t,e);var o,i=typeof t;if("number"===i)o=+t;else if("string"===i)o=r.byteLength(t,e);else{if("object"!==i||null===t)throw new TypeError("must start with number, buffer, array or string");"Buffer"===t.type&&D(t.data)&&(t=t.data),o=+t.length}if(o>N)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+N.toString(16)+" bytes");o<0?o=0:o>>>=0,r.TYPED_ARRAY_SUPPORT?n=r._augment(new Uint8Array(o)):(n.length=o,n._isBuffer=!0);var s;if(r.TYPED_ARRAY_SUPPORT&&"number"==typeof t.byteLength)n._set(t);else if(T(t))if(r.isBuffer(t))for(s=0;s<o;s++)n[s]=t.readUInt8(s);else for(s=0;s<o;s++)n[s]=(t[s]%256+256)%256;else if("string"===i)n.write(t,0,e);else if("number"===i&&!r.TYPED_ARRAY_SUPPORT)for(s=0;s<o;s++)n[s]=0;return o>0&&o<=r.poolSize&&(n.parent=j),n}function o(t,e){if(!(this instanceof o))return new o(t,e);var n=new r(t,e);return delete n.parent,n}function i(t,e,n,r){n=Number(n)||0;var o=t.length-n;r?(r=Number(r),r>o&&(r=o)):r=o;var i=e.length;if(i%2!==0)throw new Error("Invalid hex string");r>i/2&&(r=i/2);for(var s=0;s<r;s++){var u=parseInt(e.substr(2*s,2),16);if(isNaN(u))throw new Error("Invalid hex string");t[n+s]=u}return s}function s(t,e,n,r){var o=x(P(e,t.length-n),t,n,r);return o}function u(t,e,n,r){var o=x(R(e),t,n,r);return o}function a(t,e,n,r){return u(t,e,n,r)}function c(t,e,n,r){var o=x(L(e),t,n,r);return o}function f(t,e,n,r){var o=x(B(e,t.length-n),t,n,r);return o}function l(t,e,n){return 0===e&&n===t.length?k.fromByteArray(t):k.fromByteArray(t.slice(e,n))}function h(t,e,n){var r="",o="";n=Math.min(t.length,n);for(var i=e;i<n;i++)t[i]<=127?(r+=O(o)+String.fromCharCode(t[i]),o=""):o+="%"+t[i].toString(16);return r+O(o)}function p(t,e,n){var r="";n=Math.min(t.length,n);for(var o=e;o<n;o++)r+=String.fromCharCode(127&t[o]);return r}function d(t,e,n){var r="";n=Math.min(t.length,n);for(var o=e;o<n;o++)r+=String.fromCharCode(t[o]);return r}function g(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var o="",i=e;i<n;i++)o+=U(t[i]);return o}function v(t,e,n){for(var r=t.slice(e,n),o="",i=0;i<r.length;i+=2)o+=String.fromCharCode(r[i]+256*r[i+1]);return o}function y(t,e,n){if(t%1!==0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function w(t,e,n,o,i,s){if(!r.isBuffer(t))throw new TypeError("buffer must be a Buffer instance");if(e>i||e<s)throw new RangeError("value is out of bounds");if(n+o>t.length)throw new RangeError("index out of range")}function E(t,e,n,r){e<0&&(e=65535+e+1);for(var o=0,i=Math.min(t.length-n,2);o<i;o++)t[n+o]=(e&255<<8*(r?o:1-o))>>>8*(r?o:1-o)}function m(t,e,n,r){e<0&&(e=4294967295+e+1);for(var o=0,i=Math.min(t.length-n,4);o<i;o++)t[n+o]=e>>>8*(r?o:3-o)&255}function b(t,e,n,r,o,i){if(e>o||e<i)throw new RangeError("value is out of bounds");if(n+r>t.length)throw new RangeError("index out of range");if(n<0)throw new RangeError("index out of range")}function _(t,e,n,r,o){return o||b(t,e,n,4,3.4028234663852886e38,-3.4028234663852886e38),Y.write(t,e,n,r,23,4),n+4}function I(t,e,n,r,o){return o||b(t,e,n,8,1.7976931348623157e308,-1.7976931348623157e308),Y.write(t,e,n,r,52,8),n+8}function A(t){if(t=S(t).replace(C,""),t.length<2)return"";for(;t.length%4!==0;)t+="=";return t}function S(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function T(t){return D(t)||r.isBuffer(t)||t&&"object"==typeof t&&"number"==typeof t.length}function U(t){return t<16?"0"+t.toString(16):t.toString(16)}function P(t,e){e=e||1/0;for(var n,r=t.length,o=null,i=[],s=0;s<r;s++){if(n=t.charCodeAt(s),n>55295&&n<57344){if(!o){if(n>56319){(e-=3)>-1&&i.push(239,191,189);continue}if(s+1===r){(e-=3)>-1&&i.push(239,191,189);continue}o=n;continue}if(n<56320){(e-=3)>-1&&i.push(239,191,189),o=n;continue}n=o-55296<<10|n-56320|65536,o=null}else o&&((e-=3)>-1&&i.push(239,191,189),o=null);if(n<128){if((e-=1)<0)break;i.push(n)}else if(n<2048){if((e-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<2097152))throw new Error("Invalid code point");if((e-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function R(t){for(var e=[],n=0;n<t.length;n++)e.push(255&t.charCodeAt(n));return e}function B(t,e){for(var n,r,o,i=[],s=0;s<t.length&&!((e-=2)<0);s++)n=t.charCodeAt(s),r=n>>8,o=n%256,i.push(o),i.push(r);return i}function L(t){return k.toByteArray(A(t))}function x(t,e,n,r){for(var o=0;o<r&&!(o+n>=e.length||o>=t.length);o++)e[o+n]=t[o];return o}function O(t){try{return decodeURIComponent(t)}catch(t){return String.fromCharCode(65533)}}var k=t("base64-js"),Y=t("ieee754"),D=t("is-array");n.Buffer=r,n.SlowBuffer=o,n.INSPECT_MAX_BYTES=50,r.poolSize=8192;var N=1073741823,j={};r.TYPED_ARRAY_SUPPORT=function(){try{var t=new ArrayBuffer(0),e=new Uint8Array(t);return e.foo=function(){return 42},42===e.foo()&&"function"==typeof e.subarray&&0===new Uint8Array(1).subarray(1,1).byteLength}catch(t){return!1}}(),r.isBuffer=function(t){return!(null==t||!t._isBuffer)},r.compare=function(t,e){if(!r.isBuffer(t)||!r.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,o=e.length,i=0,s=Math.min(n,o);i<s&&t[i]===e[i];i++);return i!==s&&(n=t[i],o=e[i]),n<o?-1:o<n?1:0},r.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},r.concat=function(t,e){if(!D(t))throw new TypeError("list argument must be an Array of Buffers.");if(0===t.length)return new r(0);if(1===t.length)return t[0];var n;if(void 0===e)for(e=0,n=0;n<t.length;n++)e+=t[n].length;var o=new r(e),i=0;for(n=0;n<t.length;n++){var s=t[n];s.copy(o,i),i+=s.length}return o},r.byteLength=function(t,e){var n;switch(t+="",e||"utf8"){case"ascii":case"binary":case"raw":n=t.length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":n=2*t.length;break;case"hex":n=t.length>>>1;break;case"utf8":case"utf-8":n=P(t).length;break;case"base64":n=L(t).length;break;default:n=t.length}return n},r.prototype.length=void 0,r.prototype.parent=void 0,r.prototype.toString=function(t,e,n){var r=!1;if(e>>>=0,n=void 0===n||n===1/0?this.length:n>>>0,t||(t="utf8"),e<0&&(e=0),n>this.length&&(n=this.length),n<=e)return"";for(;;)switch(t){case"hex":return g(this,e,n);case"utf8":case"utf-8":return h(this,e,n);case"ascii":return p(this,e,n);case"binary":return d(this,e,n);case"base64":return l(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return v(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}},r.prototype.equals=function(t){if(!r.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===r.compare(this,t)},r.prototype.inspect=function(){var t="",e=n.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,e).match(/.{2}/g).join(" "),this.length>e&&(t+=" ... ")),"<Buffer "+t+">"},r.prototype.compare=function(t){if(!r.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t?0:r.compare(this,t)},r.prototype.indexOf=function(t,e){function n(t,e,n){for(var r=-1,o=0;n+o<t.length;o++)if(t[n+o]===e[r===-1?0:o-r]){if(r===-1&&(r=o),o-r+1===e.length)return n+r}else r=-1;return-1}if(e>2147483647?e=2147483647:e<-2147483648&&(e=-2147483648),e>>=0,0===this.length)return-1;if(e>=this.length)return-1;if(e<0&&(e=Math.max(this.length+e,0)),"string"==typeof t)return 0===t.length?-1:String.prototype.indexOf.call(this,t,e);if(r.isBuffer(t))return n(this,t,e);if("number"==typeof t)return r.TYPED_ARRAY_SUPPORT&&"function"===Uint8Array.prototype.indexOf?Uint8Array.prototype.indexOf.call(this,t,e):n(this,[t],e);throw new TypeError("val must be string, number or Buffer")},r.prototype.get=function(t){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(t)},r.prototype.set=function(t,e){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(t,e)},r.prototype.write=function(t,e,n,r){if(isFinite(e))isFinite(n)||(r=n,n=void 0);else{var o=r;r=e,e=n,n=o}if(e=Number(e)||0,n<0||e<0||e>this.length)throw new RangeError("attempt to write outside buffer bounds");var l=this.length-e;n?(n=Number(n),n>l&&(n=l)):n=l,r=String(r||"utf8").toLowerCase();var h;switch(r){case"hex":h=i(this,t,e,n);break;case"utf8":case"utf-8":h=s(this,t,e,n);break;case"ascii":h=u(this,t,e,n);break;case"binary":h=a(this,t,e,n);break;case"base64":h=c(this,t,e,n);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":h=f(this,t,e,n);break;default:throw new TypeError("Unknown encoding: "+r)}return h},r.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},r.prototype.slice=function(t,e){var n=this.length;t=~~t,e=void 0===e?n:~~e,t<0?(t+=n,t<0&&(t=0)):t>n&&(t=n),e<0?(e+=n,e<0&&(e=0)):e>n&&(e=n),e<t&&(e=t);var o;if(r.TYPED_ARRAY_SUPPORT)o=r._augment(this.subarray(t,e));else{var i=e-t;o=new r(i,(void 0));for(var s=0;s<i;s++)o[s]=this[s+t]}return o.length&&(o.parent=this.parent||this),o},r.prototype.readUIntLE=function(t,e,n){t>>>=0,e>>>=0,n||y(t,e,this.length);for(var r=this[t],o=1,i=0;++i<e&&(o*=256);)r+=this[t+i]*o;return r},r.prototype.readUIntBE=function(t,e,n){t>>>=0,e>>>=0,n||y(t,e,this.length);for(var r=this[t+--e],o=1;e>0&&(o*=256);)r+=this[t+--e]*o;return r},r.prototype.readUInt8=function(t,e){return e||y(t,1,this.length),this[t]},r.prototype.readUInt16LE=function(t,e){return e||y(t,2,this.length),this[t]|this[t+1]<<8},r.prototype.readUInt16BE=function(t,e){return e||y(t,2,this.length),this[t]<<8|this[t+1]},r.prototype.readUInt32LE=function(t,e){return e||y(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},r.prototype.readUInt32BE=function(t,e){return e||y(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},r.prototype.readIntLE=function(t,e,n){t>>>=0,e>>>=0,n||y(t,e,this.length);for(var r=this[t],o=1,i=0;++i<e&&(o*=256);)r+=this[t+i]*o;return o*=128,r>=o&&(r-=Math.pow(2,8*e)),r},r.prototype.readIntBE=function(t,e,n){t>>>=0,e>>>=0,n||y(t,e,this.length);for(var r=e,o=1,i=this[t+--r];r>0&&(o*=256);)i+=this[t+--r]*o;return o*=128,i>=o&&(i-=Math.pow(2,8*e)),i},r.prototype.readInt8=function(t,e){return e||y(t,1,this.length),128&this[t]?(255-this[t]+1)*-1:this[t]},r.prototype.readInt16LE=function(t,e){e||y(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},r.prototype.readInt16BE=function(t,e){e||y(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},r.prototype.readInt32LE=function(t,e){return e||y(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},r.prototype.readInt32BE=function(t,e){return e||y(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},r.prototype.readFloatLE=function(t,e){return e||y(t,4,this.length),Y.read(this,t,!0,23,4)},r.prototype.readFloatBE=function(t,e){return e||y(t,4,this.length),Y.read(this,t,!1,23,4)},r.prototype.readDoubleLE=function(t,e){return e||y(t,8,this.length),Y.read(this,t,!0,52,8)},r.prototype.readDoubleBE=function(t,e){return e||y(t,8,this.length),Y.read(this,t,!1,52,8)},r.prototype.writeUIntLE=function(t,e,n,r){t=+t,e>>>=0,n>>>=0,r||w(this,t,e,n,Math.pow(2,8*n),0);var o=1,i=0;for(this[e]=255&t;++i<n&&(o*=256);)this[e+i]=t/o>>>0&255;return e+n},r.prototype.writeUIntBE=function(t,e,n,r){t=+t,e>>>=0,n>>>=0,r||w(this,t,e,n,Math.pow(2,8*n),0);var o=n-1,i=1;for(this[e+o]=255&t;--o>=0&&(i*=256);)this[e+o]=t/i>>>0&255;return e+n},r.prototype.writeUInt8=function(t,e,n){return t=+t,e>>>=0,n||w(this,t,e,1,255,0),r.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=t,e+1},r.prototype.writeUInt16LE=function(t,e,n){return t=+t,e>>>=0,n||w(this,t,e,2,65535,0),r.TYPED_ARRAY_SUPPORT?(this[e]=t,this[e+1]=t>>>8):E(this,t,e,!0),e+2},r.prototype.writeUInt16BE=function(t,e,n){return t=+t,e>>>=0,n||w(this,t,e,2,65535,0),r.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=t):E(this,t,e,!1),e+2},r.prototype.writeUInt32LE=function(t,e,n){return t=+t,e>>>=0,n||w(this,t,e,4,4294967295,0),r.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=t):m(this,t,e,!0),e+4},r.prototype.writeUInt32BE=function(t,e,n){return t=+t,e>>>=0,n||w(this,t,e,4,4294967295,0),r.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=t):m(this,t,e,!1),e+4},r.prototype.writeIntLE=function(t,e,n,r){t=+t,e>>>=0,r||w(this,t,e,n,Math.pow(2,8*n-1)-1,-Math.pow(2,8*n-1));var o=0,i=1,s=t<0?1:0;for(this[e]=255&t;++o<n&&(i*=256);)this[e+o]=(t/i>>0)-s&255;return e+n},r.prototype.writeIntBE=function(t,e,n,r){t=+t,e>>>=0,r||w(this,t,e,n,Math.pow(2,8*n-1)-1,-Math.pow(2,8*n-1));var o=n-1,i=1,s=t<0?1:0;for(this[e+o]=255&t;--o>=0&&(i*=256);)this[e+o]=(t/i>>0)-s&255;return e+n},r.prototype.writeInt8=function(t,e,n){return t=+t,e>>>=0,n||w(this,t,e,1,127,-128),r.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=t,e+1},r.prototype.writeInt16LE=function(t,e,n){return t=+t,e>>>=0,n||w(this,t,e,2,32767,-32768),r.TYPED_ARRAY_SUPPORT?(this[e]=t,this[e+1]=t>>>8):E(this,t,e,!0),e+2},r.prototype.writeInt16BE=function(t,e,n){return t=+t,e>>>=0,n||w(this,t,e,2,32767,-32768),r.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=t):E(this,t,e,!1),e+2},r.prototype.writeInt32LE=function(t,e,n){return t=+t,e>>>=0,n||w(this,t,e,4,2147483647,-2147483648),r.TYPED_ARRAY_SUPPORT?(this[e]=t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):m(this,t,e,!0),e+4},r.prototype.writeInt32BE=function(t,e,n){return t=+t,e>>>=0,n||w(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),r.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=t):m(this,t,e,!1),e+4},r.prototype.writeFloatLE=function(t,e,n){return _(this,t,e,!0,n)},r.prototype.writeFloatBE=function(t,e,n){return _(this,t,e,!1,n)},r.prototype.writeDoubleLE=function(t,e,n){return I(this,t,e,!0,n)},r.prototype.writeDoubleBE=function(t,e,n){return I(this,t,e,!1,n)},r.prototype.copy=function(t,e,n,o){if(n||(n=0),o||0===o||(o=this.length),e>=t.length&&(e=t.length),e||(e=0),o>0&&o<n&&(o=n),o===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(o<0)throw new RangeError("sourceEnd out of bounds");o>this.length&&(o=this.length),t.length-e<o-n&&(o=t.length-e+n);var i=o-n;if(i<1e3||!r.TYPED_ARRAY_SUPPORT)for(var s=0;s<i;s++)t[s+e]=this[s+n];else t._set(this.subarray(n,n+i),e);return i},r.prototype.fill=function(t,e,n){if(t||(t=0),e||(e=0),n||(n=this.length),n<e)throw new RangeError("end < start");if(n!==e&&0!==this.length){if(e<0||e>=this.length)throw new RangeError("start out of bounds");if(n<0||n>this.length)throw new RangeError("end out of bounds");var r;if("number"==typeof t)for(r=e;r<n;r++)this[r]=t;else{var o=P(t.toString()),i=o.length;for(r=e;r<n;r++)this[r]=o[r%i]}return this}},r.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(r.TYPED_ARRAY_SUPPORT)return new r(this).buffer;for(var t=new Uint8Array(this.length),e=0,n=t.length;e<n;e+=1)t[e]=this[e];return t.buffer}throw new TypeError("Buffer.toArrayBuffer not supported in this browser")};var M=r.prototype;r._augment=function(t){return t.constructor=r,t._isBuffer=!0,t._set=t.set,t.get=M.get,t.set=M.set,t.write=M.write,t.toString=M.toString,t.toLocaleString=M.toString,t.toJSON=M.toJSON,t.equals=M.equals,t.compare=M.compare,t.indexOf=M.indexOf,t.copy=M.copy,t.slice=M.slice,t.readUIntLE=M.readUIntLE,t.readUIntBE=M.readUIntBE,t.readUInt8=M.readUInt8,t.readUInt16LE=M.readUInt16LE,t.readUInt16BE=M.readUInt16BE,t.readUInt32LE=M.readUInt32LE,t.readUInt32BE=M.readUInt32BE,t.readIntLE=M.readIntLE,t.readIntBE=M.readIntBE,t.readInt8=M.readInt8,t.readInt16LE=M.readInt16LE,t.readInt16BE=M.readInt16BE,t.readInt32LE=M.readInt32LE,t.readInt32BE=M.readInt32BE,t.readFloatLE=M.readFloatLE,t.readFloatBE=M.readFloatBE,t.readDoubleLE=M.readDoubleLE,t.readDoubleBE=M.readDoubleBE,t.writeUInt8=M.writeUInt8,t.writeUIntLE=M.writeUIntLE,t.writeUIntBE=M.writeUIntBE,t.writeUInt16LE=M.writeUInt16LE,t.writeUInt16BE=M.writeUInt16BE,t.writeUInt32LE=M.writeUInt32LE,t.writeUInt32BE=M.writeUInt32BE,t.writeIntLE=M.writeIntLE,t.writeIntBE=M.writeIntBE,t.writeInt8=M.writeInt8,t.writeInt16LE=M.writeInt16LE,t.writeInt16BE=M.writeInt16BE,t.writeInt32LE=M.writeInt32LE,t.writeInt32BE=M.writeInt32BE,t.writeFloatLE=M.writeFloatLE,t.writeFloatBE=M.writeFloatBE,t.writeDoubleLE=M.writeDoubleLE,t.writeDoubleBE=M.writeDoubleBE,t.fill=M.fill,t.inspect=M.inspect,t.toArrayBuffer=M.toArrayBuffer,t};var C=/[^+\/0-9A-z\-]/g},{"base64-js":3,ieee754:4,"is-array":5}],3:[function(t,e,n){var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";!function(t){"use strict";function e(t){var e=t.charCodeAt(0);return e===s||e===l?62:e===u||e===h?63:e<a?-1:e<a+10?e-a+26+26:e<f+26?e-f:e<c+26?e-c+26:void 0}function n(t){function n(t){c[l++]=t}var r,o,s,u,a,c;if(t.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var f=t.length;a="="===t.charAt(f-2)?2:"="===t.charAt(f-1)?1:0,c=new i(3*t.length/4-a),s=a>0?t.length-4:t.length;var l=0;for(r=0,o=0;r<s;r+=4,o+=3)u=e(t.charAt(r))<<18|e(t.charAt(r+1))<<12|e(t.charAt(r+2))<<6|e(t.charAt(r+3)),n((16711680&u)>>16),n((65280&u)>>8),n(255&u);return 2===a?(u=e(t.charAt(r))<<2|e(t.charAt(r+1))>>4,n(255&u)):1===a&&(u=e(t.charAt(r))<<10|e(t.charAt(r+1))<<4|e(t.charAt(r+2))>>2,n(u>>8&255),n(255&u)),c}function o(t){function e(t){return r.charAt(t)}function n(t){return e(t>>18&63)+e(t>>12&63)+e(t>>6&63)+e(63&t)}var o,i,s,u=t.length%3,a="";for(o=0,s=t.length-u;o<s;o+=3)i=(t[o]<<16)+(t[o+1]<<8)+t[o+2],a+=n(i);switch(u){case 1:i=t[t.length-1],a+=e(i>>2),a+=e(i<<4&63),a+="==";break;case 2:i=(t[t.length-2]<<8)+t[t.length-1],a+=e(i>>10),a+=e(i>>4&63),a+=e(i<<2&63),a+="="}return a}var i="undefined"!=typeof Uint8Array?Uint8Array:Array,s="+".charCodeAt(0),u="/".charCodeAt(0),a="0".charCodeAt(0),c="a".charCodeAt(0),f="A".charCodeAt(0),l="-".charCodeAt(0),h="_".charCodeAt(0);t.toByteArray=n,t.fromByteArray=o}("undefined"==typeof n?this.base64js={}:n)},{}],4:[function(t,e,n){n.read=function(t,e,n,r,o){var i,s,u=8*o-r-1,a=(1<<u)-1,c=a>>1,f=-7,l=n?o-1:0,h=n?-1:1,p=t[e+l];for(l+=h,i=p&(1<<-f)-1,p>>=-f,f+=u;f>0;i=256*i+t[e+l],l+=h,f-=8);for(s=i&(1<<-f)-1,i>>=-f,f+=r;f>0;s=256*s+t[e+l],l+=h,f-=8);if(0===i)i=1-c;else{if(i===a)return s?NaN:(p?-1:1)*(1/0);s+=Math.pow(2,r),i-=c}return(p?-1:1)*s*Math.pow(2,i-r)},n.write=function(t,e,n,r,o,i){var s,u,a,c=8*i-o-1,f=(1<<c)-1,l=f>>1,h=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:i-1,d=r?1:-1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(u=isNaN(e)?1:0,s=f):(s=Math.floor(Math.log(e)/Math.LN2),e*(a=Math.pow(2,-s))<1&&(s--,a*=2),e+=s+l>=1?h/a:h*Math.pow(2,1-l),e*a>=2&&(s++,a/=2),s+l>=f?(u=0,s=f):s+l>=1?(u=(e*a-1)*Math.pow(2,o),s+=l):(u=e*Math.pow(2,l-1)*Math.pow(2,o),s=0));o>=8;t[n+p]=255&u,p+=d,u/=256,o-=8);for(s=s<<o|u,c+=o;c>0;t[n+p]=255&s,p+=d,s/=256,c-=8);t[n+p-d]|=128*g}},{}],5:[function(t,e,n){var r=Array.isArray,o=Object.prototype.toString;e.exports=r||function(t){return!!t&&"[object Array]"==o.call(t)}},{}],6:[function(t,e,n){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function o(t){return"function"==typeof t}function i(t){return"number"==typeof t}function s(t){return"object"==typeof t&&null!==t}function u(t){return void 0===t}e.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(t){if(!i(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},r.prototype.emit=function(t){var e,n,r,i,a,c;if(this._events||(this._events={}),"error"===t&&(!this._events.error||s(this._events.error)&&!this._events.error.length)){if(e=arguments[1],e instanceof Error)throw e;throw TypeError('Uncaught, unspecified "error" event.')}if(n=this._events[t],u(n))return!1;if(o(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:for(r=arguments.length,i=new Array(r-1),a=1;a<r;a++)i[a-1]=arguments[a];n.apply(this,i)}else if(s(n)){for(r=arguments.length,i=new Array(r-1),a=1;a<r;a++)i[a-1]=arguments[a];for(c=n.slice(),r=c.length,a=0;a<r;a++)c[a].apply(this,i)}return!0},r.prototype.addListener=function(t,e){var n;if(!o(e))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,o(e.listener)?e.listener:e),this._events[t]?s(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,s(this._events[t])&&!this._events[t].warned){var n;n=u(this._maxListeners)?r.defaultMaxListeners:this._maxListeners,n&&n>0&&this._events[t].length>n&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace())}return this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(t,e){function n(){this.removeListener(t,n),r||(r=!0,e.apply(this,arguments))}if(!o(e))throw TypeError("listener must be a function");var r=!1;return n.listener=e,this.on(t,n),this},r.prototype.removeListener=function(t,e){var n,r,i,u;if(!o(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(n=this._events[t],i=n.length,r=-1,n===e||o(n.listener)&&n.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(s(n)){for(u=i;u-- >0;)if(n[u]===e||n[u].listener&&n[u].listener===e){r=u;break}if(r<0)return this;1===n.length?(n.length=0,delete this._events[t]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},r.prototype.removeAllListeners=function(t){var e,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[t],o(n))this.removeListener(t,n);else for(;n.length;)this.removeListener(t,n[n.length-1]);return delete this._events[t],this},r.prototype.listeners=function(t){var e;return e=this._events&&this._events[t]?o(this._events[t])?[this._events[t]]:this._events[t].slice():[]},r.listenerCount=function(t,e){var n;return n=t._events&&t._events[e]?o(t._events[e])?1:t._events[e].length:0}},{}],7:[function(t,e,n){"function"==typeof Object.create?e.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},{}],8:[function(t,e,n){function r(){if(!u){u=!0;for(var t,e=s.length;e;){t=s,s=[];for(var n=-1;++n<e;)t[n]();e=s.length}u=!1}}function o(){}var i=e.exports={},s=[],u=!1;i.nextTick=function(t){s.push(t),u||setTimeout(r,0)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=o,i.addListener=o,i.once=o,i.off=o,i.removeListener=o,i.removeAllListeners=o,i.emit=o,i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],9:[function(t,e,n){e.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},{}],10:[function(t,e,n){(function(e,r){function o(t,e){var r={seen:[],stylize:s};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),g(e)?r.showHidden=e:e&&n._extend(r,e),b(r.showHidden)&&(r.showHidden=!1),b(r.depth)&&(r.depth=2),b(r.colors)&&(r.colors=!1),b(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=i),a(r,t,r.depth)}function i(t,e){var n=o.styles[e];return n?"["+o.colors[n][0]+"m"+t+"["+o.colors[n][1]+"m":t}function s(t,e){return t}function u(t){var e={};return t.forEach(function(t,n){e[t]=!0}),e}function a(t,e,r){if(t.customInspect&&e&&T(e.inspect)&&e.inspect!==n.inspect&&(!e.constructor||e.constructor.prototype!==e)){var o=e.inspect(r,t);return E(o)||(o=a(t,o,r)),o}var i=c(t,e);if(i)return i;var s=Object.keys(e),g=u(s);if(t.showHidden&&(s=Object.getOwnPropertyNames(e)),S(e)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return f(e);if(0===s.length){if(T(e)){var v=e.name?": "+e.name:"";return t.stylize("[Function"+v+"]","special")}if(_(e))return t.stylize(RegExp.prototype.toString.call(e),"regexp");if(A(e))return t.stylize(Date.prototype.toString.call(e),"date");if(S(e))return f(e)}var y="",w=!1,m=["{","}"];if(d(e)&&(w=!0,m=["[","]"]),T(e)){var b=e.name?": "+e.name:"";y=" [Function"+b+"]"}if(_(e)&&(y=" "+RegExp.prototype.toString.call(e)),A(e)&&(y=" "+Date.prototype.toUTCString.call(e)),S(e)&&(y=" "+f(e)),0===s.length&&(!w||0==e.length))return m[0]+y+m[1];if(r<0)return _(e)?t.stylize(RegExp.prototype.toString.call(e),"regexp"):t.stylize("[Object]","special");t.seen.push(e);var I;return I=w?l(t,e,r,g,s):s.map(function(n){return h(t,e,r,g,n,w)}),t.seen.pop(),p(I,y,m)}function c(t,e){if(b(e))return t.stylize("undefined","undefined");if(E(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}return w(e)?t.stylize(""+e,"number"):g(e)?t.stylize(""+e,"boolean"):v(e)?t.stylize("null","null"):void 0}function f(t){return"["+Error.prototype.toString.call(t)+"]"}function l(t,e,n,r,o){for(var i=[],s=0,u=e.length;s<u;++s)L(e,String(s))?i.push(h(t,e,n,r,String(s),!0)):i.push("");return o.forEach(function(o){o.match(/^\d+$/)||i.push(h(t,e,n,r,o,!0))}),i}function h(t,e,n,r,o,i){var s,u,c;if(c=Object.getOwnPropertyDescriptor(e,o)||{value:e[o]},c.get?u=c.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):c.set&&(u=t.stylize("[Setter]","special")),L(r,o)||(s="["+o+"]"),u||(t.seen.indexOf(c.value)<0?(u=v(n)?a(t,c.value,null):a(t,c.value,n-1),u.indexOf("\n")>-1&&(u=i?u.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+u.split("\n").map(function(t){return"   "+t}).join("\n"))):u=t.stylize("[Circular]","special")),b(s)){if(i&&o.match(/^\d+$/))return u;s=JSON.stringify(""+o),s.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=t.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=t.stylize(s,"string"))}return s+": "+u}function p(t,e,n){var r=0,o=t.reduce(function(t,e){return r++,e.indexOf("\n")>=0&&r++,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0);return o>60?n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1]:n[0]+e+" "+t.join(", ")+" "+n[1]}function d(t){return Array.isArray(t)}function g(t){return"boolean"==typeof t}function v(t){return null===t}function y(t){return null==t}function w(t){return"number"==typeof t}function E(t){return"string"==typeof t}function m(t){return"symbol"==typeof t}function b(t){return void 0===t}function _(t){return I(t)&&"[object RegExp]"===P(t)}function I(t){return"object"==typeof t&&null!==t}function A(t){return I(t)&&"[object Date]"===P(t)}function S(t){return I(t)&&("[object Error]"===P(t)||t instanceof Error)}function T(t){return"function"==typeof t}function U(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||"undefined"==typeof t}function P(t){return Object.prototype.toString.call(t)}function R(t){return t<10?"0"+t.toString(10):t.toString(10)}function B(){var t=new Date,e=[R(t.getHours()),R(t.getMinutes()),R(t.getSeconds())].join(":");return[t.getDate(),Y[t.getMonth()],e].join(" ")}function L(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var x=/%[sdj%]/g;n.format=function(t){if(!E(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(o(arguments[n]));return e.join(" ")}for(var n=1,r=arguments,i=r.length,s=String(t).replace(x,function(t){if("%%"===t)return"%";if(n>=i)return t;switch(t){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"}default:return t}}),u=r[n];n<i;u=r[++n])s+=v(u)||!I(u)?" "+u:" "+o(u);return s},n.deprecate=function(t,o){function i(){if(!s){if(e.throwDeprecation)throw new Error(o);e.traceDeprecation?console.trace(o):console.error(o),s=!0}return t.apply(this,arguments)}if(b(r.process))return function(){return n.deprecate(t,o).apply(this,arguments)};if(e.noDeprecation===!0)return t;var s=!1;return i};var O,k={};n.debuglog=function(t){if(b(O)&&(O=e.env.NODE_DEBUG||""),t=t.toUpperCase(),!k[t])if(new RegExp("\\b"+t+"\\b","i").test(O)){var r=e.pid;k[t]=function(){var e=n.format.apply(n,arguments);console.error("%s %d: %s",t,r,e)}}else k[t]=function(){};return k[t]},n.inspect=o,o.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},o.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},n.isArray=d,n.isBoolean=g,n.isNull=v,n.isNullOrUndefined=y,n.isNumber=w,n.isString=E,n.isSymbol=m,n.isUndefined=b,n.isRegExp=_,n.isObject=I,n.isDate=A,n.isError=S,n.isFunction=T,n.isPrimitive=U,n.isBuffer=t("./support/isBuffer");var Y=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];n.log=function(){console.log("%s - %s",B(),n.format.apply(n,arguments))},n.inherits=t("inherits"),n._extend=function(t,e){if(!e||!I(e))return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t}}).call(this,t("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":9,_process:8,inherits:7}],11:[function(t,e,n){!function(){var t="js-websocket",n="0.0.1",r=window.Protocol,o=window.protobuf,i=window.decodeIO_protobuf,s=null,u=null,a=r.Package,c=r.Message,f=window.EventEmitter,l=window.rsa;"undefined"!=typeof window&&"undefined"!=typeof sys&&sys.localStorage&&(window.localStorage=sys.localStorage);var h=200,p=501;"function"!=typeof Object.create&&(Object.create=function(t){function e(){}return e.prototype=t,new e});var d=window,g=Object.create(f.prototype);d.pomelo=g;var v,y=null,w=0,E={},m={},b={},_={},I={},A={},S={},T=0,U=0,P=0,R=0,B=100,L=null,x=null,O=null,k=null,Y=null,D=!1,N=null,j=null,M=0,C=5e3,J=10,F={sys:{type:t,version:n,rsa:{}},user:{}},H=null;g.init=function(t,e){H=e;var n=t.host,r=t.port;Y=t.encode||q,k=t.decode||z;var o="ws://"+n;if(r&&(o+=":"+r),F.user=t.user,t.encrypt){v=!0,l.generate(1024,"10001");var i={rsa_n:l.n.toString(16),rsa_e:l.e};F.sys.rsa=i}O=t.handshakeCallback,K(t,o,e)};var z=g.decode=function(t){
var e=c.decode(t);if(!(e.id>0)||(e.route=b[e.id],delete b[e.id],e.route))return e.body=rt(e),e},q=g.encode=function(t,e,n){var i=t?c.TYPE_REQUEST:c.TYPE_NOTIFY;if(o&&S[e])n=o.encode(e,n);else if(s&&s.lookup(e)){var u=s.build(e);n=new u(n).encodeNB()}else n=r.strencode(JSON.stringify(n));var a=0;return _&&_[e]&&(e=_[e],a=1),c.encode(t,i,a,e,n)},K=function(t,e,n){console.log("connect to "+e);var t=t||{},c=t.maxReconnectAttempts||J;if(j=e,window.localStorage&&window.localStorage.getItem("protos")&&0===T){var f=JSON.parse(window.localStorage.getItem("protos"));T=f.version||0,A=f.server||{},S=f.client||{},o&&o.init({encoderProtos:S,decoderProtos:A}),i&&(s=i.loadJson(S),u=i.loadJson(A))}F.sys.protoVersion=T;var l=function(t){D&&g.emit("reconnect"),$();var e=a.encode(a.TYPE_HANDSHAKE,r.strencode(JSON.stringify(F)));G(e)},h=function(t){et(a.decode(t.data),n),P&&(R=Date.now()+P)},p=function(t){g.emit("io-error",t),console.error("socket error: ",t)},d=function(e){g.emit("close",e),g.emit("disconnect",e),console.error("socket close: ",e),t.reconnect&&M<c&&(D=!0,M++,N=setTimeout(function(){K(t,j,n)},C),C*=2)};y=new WebSocket(e),y.binaryType="arraybuffer",y.onopen=l,y.onmessage=h,y.onerror=p,y.onclose=d};g.disconnect=function(){y&&(y.disconnect&&y.disconnect(),y.close&&y.close(),console.log("disconnect"),y=null),L&&(clearTimeout(L),L=null),x&&(clearTimeout(x),x=null)};var $=function(){D=!1,C=5e3,M=0,clearTimeout(N)};g.request=function(t,e,n){2===arguments.length&&"function"==typeof e?(n=e,e={}):e=e||{},t=t||e.route,t&&(w++,Q(w,t,e),E[w]=n,b[w]=t)},g.notify=function(t,e){e=e||{},Q(0,t,e)};var Q=function(t,e,n){if(v){n=JSON.stringify(n);var r=l.signString(n,"sha256");n=JSON.parse(n),n.__crypto__=r}Y&&(n=Y(t,e,n));var o=a.encode(a.TYPE_DATA,n);G(o)},G=function(t){y&&y.send(t.buffer)},X=function(t){if(U){var e=a.encode(a.TYPE_HEARTBEAT);x&&(clearTimeout(x),x=null),L||(L=setTimeout(function(){L=null,G(e),R=Date.now()+P,x=setTimeout(Z,P)},U))}},Z=function(){var t=R-Date.now();t>B?x=setTimeout(Z,t):(console.error("server heartbeat timeout"),g.emit("heartbeat timeout"),g.disconnect())},V=function(t){if(t=JSON.parse(r.strdecode(t)),t.code===p)return void g.emit("error","client version not fullfill");if(t.code!==h)return void g.emit("error","handshake fail");ot(t);var e=a.encode(a.TYPE_HANDSHAKE_ACK);G(e),H&&H(y)},W=function(t){var e=t;k&&(e=k(e)),nt(g,e)},tt=function(t){t=JSON.parse(r.strdecode(t)),g.emit("onKick",t)};m[a.TYPE_HANDSHAKE]=V,m[a.TYPE_HEARTBEAT]=X,m[a.TYPE_DATA]=W,m[a.TYPE_KICK]=tt;var et=function(t){if(Array.isArray(t))for(var e=0;e<t.length;e++){var n=t[e];m[n.type](n.body)}else m[t.type](t.body)},nt=function(t,e){if(!e.id)return void t.emit(e.route,e.body);var n=E[e.id];delete E[e.id],"function"==typeof n&&n(e.body)},rt=function(t){var e=t.route;if(t.compressRoute){if(!I[e])return{};e=t.route=I[e]}return o&&A[e]?o.decodeStr(e,t.body):u&&u.lookup(e)?u.build(e).decode(t.body):JSON.parse(r.strdecode(t.body))},ot=function(t){t.sys&&t.sys.heartbeat?(U=1e3*t.sys.heartbeat,P=2*U):(U=0,P=0),it(t),"function"==typeof O&&O(t.user)},it=function(t){if(t&&t.sys){_=t.sys.dict;var e=t.sys.protos;if(_){_=_,I={};for(var n in _)I[_[n]]=n}e&&(T=e.version||0,A=e.server||{},S=e.client||{},window.localStorage.setItem("protos",JSON.stringify(e)),o&&o.init({encoderProtos:e.client,decoderProtos:e.server}),i&&(s=i.loadJson(S),u=i.loadJson(A)))}};e.exports=g}()},{}],12:[function(t,e,n){var r=e.exports;r.encodeUInt32=function(t){var e=parseInt(t);if(isNaN(e)||e<0)return console.log(e),null;var n=[];do{var r=e%128,o=Math.floor(e/128);0!==o&&(r+=128),n.push(r),e=o}while(0!==e);return n},r.encodeSInt32=function(t){var e=parseInt(t);return isNaN(e)?null:(e=e<0?2*Math.abs(e)-1:2*e,r.encodeUInt32(e))},r.decodeUInt32=function(t){for(var e=0,n=0;n<t.length;n++){var r=parseInt(t[n]);if(e+=(127&r)*Math.pow(2,7*n),r<128)return e}return e},r.decodeSInt32=function(t){var e=this.decodeUInt32(t),n=e%2===1?-1:1;return e=(e%2+e)/2*n}},{}],13:[function(t,e,n){e.exports={TYPES:{uInt32:0,sInt32:0,int32:0,double:1,string:2,message:2,float:5}}},{}],14:[function(t,e,n){function r(t,e,n){for(;h<n;){var r=o(),u=(r.type,r.tag),a=e.__tags[u];switch(e[a].option){case"optional":case"required":t[a]=i(e[a].type,e);break;case"repeated":t[a]||(t[a]=[]),s(t[a],e[a].type,e)}}return t}function o(){var t=c.decodeUInt32(u());return{type:7&t,tag:t>>3}}function i(t,e){switch(t){case"uInt32":return c.decodeUInt32(u());case"int32":case"sInt32":return c.decodeSInt32(u());case"float":var n=a.readFloatLE(h);return h+=4,n;case"double":var o=a.readDoubleLE(h);return h+=8,o;case"string":var i=c.decodeUInt32(u()),s=a.toString("utf8",h,h+i);return h+=i,s;default:var f=e&&(e.__messages[t]||l.protos["message "+t]);if(f){var i=c.decodeUInt32(u()),p={};return r(p,f,h+i),p}}}function s(t,e,n){if(f.isSimpleType(e))for(var r=c.decodeUInt32(u()),o=0;o<r;o++)t.push(i(e));else t.push(i(e,n))}function u(t){var e=[],n=h;t=t||!1;var r;do{var r=a.readUInt8(n);e.push(r),n++}while(r>=128);return t||(h=n),e}var a,c=t("./codec"),f=t("./util"),l=e.exports,h=0;l.init=function(t){this.protos=t||{}},l.setProtos=function(t){t&&(this.protos=t)},l.decode=function(t,e){var n=this.protos[t];return a=e,h=0,n?r({},n,a.length):null}},{"./codec":12,"./util":18}],15:[function(t,e,n){(function(n){function r(t,e){if(!e||!t)return console.warn("no protos or msg exist! msg : %j, protos : %j",t,e),!1;for(var n in e){var o=e[n];switch(o.option){case"required":if("undefined"==typeof t[n])return console.warn("no property exist for required! name: %j, proto: %j, msg: %j",n,o,t),!1;case"optional":if("undefined"!=typeof t[n]){var i=e.__messages[o.type]||h.protos["message "+o.type];if(i&&!r(t[n],i))return console.warn("inner proto error! name: %j, proto: %j, msg: %j",n,o,t),!1}break;case"repeated":var i=e.__messages[o.type]||h.protos["message "+o.type];if(t[n]&&i)for(var s=0;s<t[n].length;s++)if(!r(t[n][s],i))return!1}}return!0}function o(t,e,n,r){for(var o in r)if(n[o]){var c=n[o];switch(c.option){case"required":case"optional":e=u(t,e,a(c.type,c.tag)),e=i(r[o],c.type,e,t,n);break;case"repeated":r[o]&&r[o].length>0&&(e=s(r[o],c,e,t,n))}}return e}function i(t,e,r,i,s){var a=0;switch(e){case"uInt32":r=u(i,r,c.encodeUInt32(t));break;case"int32":case"sInt32":r=u(i,r,c.encodeSInt32(t));break;case"float":i.writeFloatLE(t,r),r+=4;break;case"double":i.writeDoubleLE(t,r),r+=8;break;case"string":a=n.byteLength(t),r=u(i,r,c.encodeUInt32(a)),i.write(t,r,a),r+=a;break;default:var f=s.__messages[e]||h.protos["message "+e];if(f){var l=new n(2*n.byteLength(JSON.stringify(t)));a=0,a=o(l,a,f,t),r=u(i,r,c.encodeUInt32(a)),l.copy(i,r,0,a),r+=a}}return r}function s(t,e,n,r,o){var s=0;if(l.isSimpleType(e.type))for(n=u(r,n,a(e.type,e.tag)),n=u(r,n,c.encodeUInt32(t.length)),s=0;s<t.length;s++)n=i(t[s],e.type,n,r);else for(s=0;s<t.length;s++)n=u(r,n,a(e.type,e.tag)),n=i(t[s],e.type,n,r,o);return n}function u(t,e,n){for(var r=0;r<n.length;r++)t.writeUInt8(n[r],e),e++;return e}function a(t,e){var n=f.TYPES[t];return void 0===n&&(n=2),c.encodeUInt32(e<<3|n)}var c=t("./codec"),f=t("./constant"),l=t("./util"),h=e.exports;h.init=function(t){this.protos=t||{}},h.encode=function(t,e){if(!t||!e)return console.warn("Route or msg can not be null! route : %j, msg %j",t,e),null;var i=this.protos[t];if(!r(e,i))return console.warn("check msg failed! msg : %j, proto : %j",e,i),null;var s=2*n.byteLength(JSON.stringify(e)),u=new n(s),a=0;return i&&(a=o(u,a,i,e),a>0)?u.slice(0,a):null}}).call(this,t("buffer").Buffer)},{"./codec":12,"./constant":13,"./util":18,buffer:2}],16:[function(t,e,n){function r(t){var e={},n={},o={};for(var i in t){var s=t[i],u=i.split(" ");switch(u[0]){case"message":if(2!==u.length)continue;n[u[1]]=r(s);continue;case"required":case"optional":case"repeated":if(3!==u.length||o[s])continue;e[u[2]]={option:u[0],type:u[1],tag:s},o[s]=u[2]}}return e.__messages=n,e.__tags=o,e}var o=e.exports;o.parse=function(t){var e={};for(var n in t)e[n]=r(t[n]);return e}},{}],17:[function(t,e,n){(function(n){var r=t("./encoder"),o=t("./decoder"),i=t("./parser"),s=e.exports;s.encode=function(t,e){return r.encode(t,e)},s.encode2Bytes=function(t,e){var n=this.encode(t,e);if(!n||!n.length)return console.warn("encode msg failed! key : %j, msg : %j",t,e),null;for(var r=new Uint8Array(n.length),o=0;o<n.length;o++)r[o]=n.readUInt8(o);return r},s.encodeStr=function(t,e,n){n=n||"base64";var r=s.encode(t,e);return r?r.toString(n):r},s.decode=function(t,e){return o.decode(t,e)},s.decodeStr=function(t,e,r){r=r||"base64";var o=new n(e,r);return o?s.decode(t,o):o},s.parse=function(t){return i.parse(t)},s.setEncoderProtos=function(t){r.init(t)},s.setDecoderProtos=function(t){o.init(t)},s.init=function(t){r.init(t.encoderProtos),o.init(t.decoderProtos)}}).call(this,t("buffer").Buffer)},{"./decoder":14,"./encoder":15,"./parser":16,buffer:2}],18:[function(t,e,n){var r=e.exports;r.isSimpleType=function(t){return"uInt32"===t||"sInt32"===t||"int32"===t||"uInt64"===t||"sInt64"===t||"float"===t||"double"===t},r.equal=function(t,e){for(var n in t){var o=t[n],i=e[n];if("object"==typeof o){if(!r.equal(o,i))return!1}else if(o!==i)return!1}return!0}},{}],19:[function(t,e,n){e.exports=t("./lib/protocol")},{"./lib/protocol":20}],20:[function(t,e,n){(function(t){!function(n,r,o){var i=n,s=4,u=1,a=2,c=1,f=65535,l=1,h=7,p=i.Package={},d=i.Message={};p.TYPE_HANDSHAKE=1,p.TYPE_HANDSHAKE_ACK=2,p.TYPE_HEARTBEAT=3,p.TYPE_DATA=4,p.TYPE_KICK=5,d.TYPE_REQUEST=0,d.TYPE_NOTIFY=1,d.TYPE_RESPONSE=2,d.TYPE_PUSH=3,i.strencode=function(e){if("undefined"!=typeof t&&r===t)return new t(e);for(var n=new r(3*e.length),o=0,i=0;i<e.length;i++){var s=e.charCodeAt(i),u=null;u=s<=127?[s]:s<=2047?[192|s>>6,128|63&s]:[224|s>>12,128|(4032&s)>>6,128|63&s];for(var a=0;a<u.length;a++)n[o]=u[a],++o}var c=new r(o);return g(c,0,n,0,o),c},i.strdecode=function(e){if("undefined"!=typeof t&&r===t)return e.toString();for(var n=new r(e),o=[],i=0,s=0,u=n.length;i<u;)n[i]<128?(s=n[i],i+=1):n[i]<224?(s=((31&n[i])<<6)+(63&n[i+1]),i+=2):(s=((15&n[i])<<12)+((63&n[i+1])<<6)+(63&n[i+2]),i+=3),o.push(s);return String.fromCharCode.apply(null,o)},p.encode=function(t,e){var n=e?e.length:0,o=new r(s+n),i=0;return o[i++]=255&t,o[i++]=n>>16&255,o[i++]=n>>8&255,o[i++]=255&n,e&&g(o,i,e,0,n),o},p.decode=function(t){for(var e=0,n=new r(t),o=0,i=[];e<n.length;){var s=n[e++];o=(n[e++]<<16|n[e++]<<8|n[e++])>>>0;var u=o?new r(o):null;u&&g(u,0,n,e,o),e+=o,i.push({type:s,body:u})}return 1===i.length?i[0]:i},d.encode=function(t,e,n,o,s){var f=v(e)?w(t):0,l=u+f;if(y(e))if(n){if("number"!=typeof o)throw new Error("error flag for number route!");l+=a}else if(l+=c,o){if(o=i.strencode(o),o.length>255)throw new Error("route maxlength is overflow");l+=o.length}s&&(l+=s.length);var h=new r(l),p=0;return p=E(e,n,h,p),v(e)&&(p=m(t,h,p)),y(e)&&(p=b(n,o,h,p)),s&&(p=_(s,h,p)),h},d.decode=function(t){var e=new r(t),n=e.length||e.byteLength,o=0,s=0,u=null,a=e[o++],c=a&l,f=a>>1&h;if(v(f)){var p=0,d=0;do p=parseInt(e[o]),s+=(127&p)<<7*d,o++,d++;while(p>=128)}if(y(f))if(c)u=e[o++]<<8|e[o++];else{var w=e[o++];w?(u=new r(w),g(u,0,e,o,w),u=i.strdecode(u)):u="",o+=w}var E=n-o,m=new r(E);return g(m,0,e,o,E),{id:s,type:f,compressRoute:c,route:u,body:m}};var g=function(t,e,n,r,o){if("function"==typeof n.copy)n.copy(t,e,r,r+o);else for(var i=0;i<o;i++)t[e++]=n[r++]},v=function(t){return t===d.TYPE_REQUEST||t===d.TYPE_RESPONSE},y=function(t){return t===d.TYPE_REQUEST||t===d.TYPE_NOTIFY||t===d.TYPE_PUSH},w=function(t){var e=0;do e+=1,t>>=7;while(t>0);return e},E=function(t,e,n,r){if(t!==d.TYPE_REQUEST&&t!==d.TYPE_NOTIFY&&t!==d.TYPE_RESPONSE&&t!==d.TYPE_PUSH)throw new Error("unkonw message type: "+t);return n[r]=t<<1|(e?1:0),r+u},m=function(t,e,n){do{var r=t%128,o=Math.floor(t/128);0!==o&&(r+=128),e[n++]=r,t=o}while(0!==t);return n},b=function(t,e,n,r){if(t){if(e>f)throw new Error("route number is overflow");n[r++]=e>>8&255,n[r++]=255&e}else e?(n[r++]=255&e.length,g(n,r,e,0,e.length),r+=e.length):n[r++]=0;return r},_=function(t,e,n){return g(e,n,t,0,t.length),n+t.length};e.exports=i,"undefined"!=typeof window&&(window.Protocol=i)}("undefined"==typeof window?e.exports:this.Protocol={},"undefined"==typeof window?t:Uint8Array,this)}).call(this,t("buffer").Buffer)},{buffer:2}]},{},[1]);var jm=jm||{};"undefined"!=typeof exports&&"undefined"!=typeof module&&(jm=require("jm-sdk-core")),function(){if(!jm.sdk.gameclient){var t=jm.sdk,e=(t.$,t.consts.ERR,t.storage),n=t.logger,r=t.utils,o=o||window.pomelo;t.on("init",function(e){var n="gameclient";e[n]=e[n]||{},e[n].host=e[n].host||e.host||"127.0.0.1",e[n].port=e[n].port||e.port||21e3,e[n].reconnect=e[n].reconnect||e.reconnect||!1,e[n].maxReconnectAttempts=e[n].maxReconnectAttempts||e.maxReconnectAttempts||0,t[n].init(e[n])}),t.gameclient={connecter:o,init:function(t){t=t||{},this.host=t.host,this.port=t.port,this.reconnect=t.reconnect,this.maxReconnectAttempts=t.maxReconnectAttempts,this.onDisconnect&&this.onMessage("disconnect",this.onDisconnect.bind(this)),this.onKick&&this.onMessage("onKick",this.onKick.bind(this))},connect:function(t,r){var i=this;t=t||{},this.online=!1,this.state="queryConnector",o.init({host:t.host||this.host,port:t.port||this.port},function(){i.online=!0;var s=t.token||e.getItem("token");i.request("gate.gateHandler.queryConnector",{token:s},function(e){o.disconnect();var s=null;if(e.err&&(s=new Error(e.msg)),s)return n.error(s.stack),void(r&&r(s,e));var u=setInterval(function(){i.online||(clearInterval(u),e.token=t.token,e.reconnect=t.reconnect,e.maxReconnectAttempts=t.maxReconnectAttempts,i._connect(e,r))},100)})})},_connect:function(t,r){var i=this;t=t||{},this.online=!1,this.state="connect",o.init(t,function(){i.online=!0,i.state="";var o=t.token||e.getItem("token");i.request("connector.connectorHandler.connect",{token:o},function(t){var e=null;t.err&&(e=new Error(t.msg)),e&&n.error(e.stack),i.emit("onConnected",e,t),r&&r(e,t)})})},disconnect:function(){this.state="disconnect",o.disconnect()},request:function(t,e,i){this.online&&(e=e||{},o.request(t,e,function(e){n.debug("[request]"+t+": "+r.formatJSON(e)),i&&i(e)}))},notify:function(t,e){this.online&&(e=e||{},n.debug("[notify]"+t+": "+r.formatJSON(e)),o.notify(t,e))},idle:function(){this.notify("connector.connectorHandler.idle")},heartbeat:function(){this.notify("connector.connectorHandler.heartbeat")},onMessage:function(t,e){o.on(t,function(o){n.debug("[onMessage]"+t+": "+r.formatJSON(o)),e(o)})},onKick:function(t){n.info("被服务器踢下线"),this.state="onKick",this.emit("onKick",t)},onDisconnect:function(){o.disconnect(),this.online?(this.online=!1,""==this.state?(n.info("连接异常中断"),this.emit("onDisconnected",!0)):(n.debug("连接正常中断"),this.emit("onDisconnected",!1))):""!==this.state&&"disconnect"!==this.state&&(this.emit("onConnectFail"),n.info("连接服务器失败"))}},jm.enableEvent(t.gameclient)}}();